{include file="common/head"/}
<script>
    var ADMIN = '__STATIC__/admin/';
</script>
<div class="layui-layout layui-layout-admin kit-layout-admin">
    <div class="layui-padded-15">
        <blockquote class="layui-elem-quote layui-text">
            <h3>当前位置：用户管理 > 用户信息</h3>
        </blockquote>
        <fieldset class="layui-elem-field layui-field-title layui-margin-t-20">
            <legend>用户列表</legend>
        </fieldset>
        <div class="layui-form">
            <table class="layui-table" lay-even="" lay-skin="row">
                <colgroup>
                    <col width="60">
                    <col width="100">
                    <col width="120">
                    <col width="120">
                    <col width="150">
                    <col width="60">
                    <col width="300">
                    <col width="300">
                    <col width="120">
                    <col>
                </colgroup>
                <thead>
                    <tr>
                      <th>序号</th>
                      <th>账号</th>
                      <th>姓名</th>
                      <th>电话</th>
                      <th>Email</th>
                      <th>等级</th>
                      <th>编辑顺序</th>
                      <th>审核顺序</th>
                      <th>注册时间</th>
                      <th>操作</th>
                    </tr> 
                </thead>
                <tbody>
                  {volist name="user" key="key" id="vo"}
                    <tr>
                      <td>{$key}</td>
                      <td>{$vo.username}</td>
                      <td>{$vo.realname}</td>
                      <td>{$vo.tel}</td>
                      <td>{$vo.email}</td>
                      <td>{$vo.level}</td>
                      <td>{$vo.edit_order}</td>
                      <td>{$vo.judge_order}</td>
                      <td>{$vo.create_time|date='Y-m-d',###}</td>
                      <td>
                        <a href="javascript:;" data-uid="{$vo.id}" class="del layui-action-del-bg" title="删除"><i class="fa fa-trash" aria-hidden="true"></i> <span>删除</span></a>
                        <a href="{:url('user/userEdit',['id'=>$vo.id])}" class="layui-action-edit-bg" title="编辑"><i class="fa fa-edit" aria-hidden="true"></i> <span>编辑</span></a>
                        <a href="javascript:;" data-uid="{$vo.id}" class="repwd layui-action-bg" title="重置密码"><i class="fa fa-repeat" aria-hidden="true"></i> <span>重置密码</span></a>
                      </td>
                    </tr>
                  {/volist}
                </tbody>
            </table>  
        </div>
    </div>
</div>
{include file="common/foot"/}
<script>
    var message;
    layui.config({
        base: ADMIN+'build/js/',
        version: '1.0.1'
    }).use(['app', 'message'], function() {
        var app = layui.app,
            $ = layui.jquery,
            layer = layui.layer;
        //将message设置为全局以便子页面调用
        message = layui.message;
        //主入口
        app.set({
            type: 'iframe'
        }).init();
    //恢复密码
    $('.repwd').click(function(){
        var j = $(this).data("uid");
        layer.confirm('您确定要重置密码吗？',{icon:3},function(data){
            var loading = layer.load(1, {shade: [0.1, '#fff']});
            $.post('{:url("user/resetPwd")}', {id:j}, function (res) {
                layer.close(loading);
                if (res.code > 0) {
                    layer.msg(res.msg, {time: 1800, icon: 1}, function () {
                        location.href = res.url;
                    });
                } else {
                    layer.msg(res.msg, {time: 1800, icon: 2});
                }
            });

        });
    });
    //删除用户
    $('.del').click(function(){
        var j = $(this).data("uid");
        layer.confirm('您确定要删除该用户吗？',{icon:3},function(data){
            var loading = layer.load(1, {shade: [0.1, '#fff']});
            $.post('{:url("user/userDel")}', {id:j}, function (res) {
                layer.close(loading);
                if (res.code > 0) {
                    layer.msg(res.msg, {time: 1800, icon: 1}, function () {
                        location.href = res.url;
                    });
                } else {
                    layer.msg(res.msg, {time: 1800, icon: 2});
                }
            });

        });
    });  
        
  });
</script>
</body>
</html>